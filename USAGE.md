# LakeFS VSCode Extension ä½¿ç”¨è¯´æ˜

## åŠŸèƒ½æ¦‚è¿°

è¿™ä¸ªVSCodeæ‰©å±•ä¸ºLakeFSæä¾›äº†ç±»ä¼¼Gitçš„ç•Œé¢ï¼Œè®©ä½ å¯ä»¥åœ¨VSCodeä¸­ç›´æ¥æ‰§è¡ŒLakeFSçš„åŸºæœ¬æ“ä½œã€‚

## ä¸»è¦åŠŸèƒ½

### 1. LakeFS é¢æ¿
æ‰©å±•ä¼šåœ¨VSCodeçš„èµ„æºç®¡ç†å™¨ä¸­æ·»åŠ ä¸€ä¸ª"LakeFS"é¢æ¿ï¼Œæä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š

#### å½“lakectlæœªå®‰è£…æ—¶ï¼š
- æ˜¾ç¤ºè­¦å‘Šä¿¡æ¯ï¼š"âš ï¸ lakectl not installed"
- ç‚¹å‡»å¯ç›´æ¥æ‰“å¼€LakeFSå®‰è£…æ–‡æ¡£

#### å½“lakectlå·²å®‰è£…æ—¶ï¼š
- **Repository Status**: æŸ¥çœ‹ä»“åº“çŠ¶æ€
- **Commit Changes**: æäº¤æ›´æ”¹
- **Open Web UI**: åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ä»“åº“çš„Webç•Œé¢

### 2. çŠ¶æ€æŸ¥çœ‹åŠŸèƒ½
ç‚¹å‡»"Repository Status"æŒ‰é’®ä¼šï¼š
1. æ‰§è¡Œ `lakectl local status` å‘½ä»¤
2. åœ¨æ–°æ–‡æ¡£çª—å£ä¸­æ˜¾ç¤ºçŠ¶æ€ç»“æœ
3. åœ¨"LakeFS"è¾“å‡ºé€šé“ä¸­è®°å½•æ‰§è¡Œæ—¥å¿—

### 3. æäº¤åŠŸèƒ½
ç‚¹å‡»"Commit Changes"æŒ‰é’®ä¼šå¯åŠ¨äº¤äº’å¼æäº¤æµç¨‹ï¼š

1. **è¾“å…¥æäº¤æ¶ˆæ¯**: å¿…å¡«å­—æ®µï¼Œä¸èƒ½ä¸ºç©º
2. **æ·»åŠ å…ƒæ•°æ®ï¼ˆå¯é€‰ï¼‰**:
   - é€‰æ‹©"Add metadata"å¯ä»¥æ·»åŠ key-valueå¯¹
   - é€‰æ‹©"Finish and commit"å®Œæˆæäº¤
   - å¯ä»¥æ·»åŠ å¤šä¸ªå…ƒæ•°æ®
3. **æ‰§è¡Œæäº¤**: è‡ªåŠ¨æ„å»ºå¹¶æ‰§è¡Œç±»ä¼¼ä»¥ä¸‹çš„å‘½ä»¤ï¼š
   ```bash
   lakectl local commit . -m "your message" --meta "key1=value1" --meta "key2=value2"
   ```

### 4. Web UIåŠŸèƒ½
ç‚¹å‡»"Open Web UI"æŒ‰é’®ä¼šï¼š

1. **è¯»å–é…ç½®**: ä»ä»¥ä¸‹ä½ç½®æŸ¥æ‰¾lakectlé…ç½®
   - `~/.lakectl.yaml` æˆ– `~/.lakectl.yml`
   - è·å– `server.endpoint_url` å­—æ®µ
2. **è§£æä»“åº“ä¿¡æ¯**: ä»å·¥ä½œåŒºçš„ `.lakefs_ref.yaml` æ–‡ä»¶ä¸­
   - è·å– `src` å­—æ®µï¼Œæ ¼å¼å¦‚ `lakefs://repo-name/branch/path`
   - æå–ä»“åº“åç§°å’Œåˆ†æ”¯
3. **æ‰“å¼€æµè§ˆå™¨**: æ„å»ºURLå¹¶åœ¨é»˜è®¤æµè§ˆå™¨ä¸­æ‰“å¼€
   - æ ¼å¼: `https://your-lakefs-server/repositories/repo-name/objects`

#### é…ç½®è¦æ±‚
ä¸ºäº†ä½¿ç”¨Web UIåŠŸèƒ½ï¼Œéœ€è¦ç¡®ä¿ï¼š

1. **lakectlé…ç½®æ–‡ä»¶å­˜åœ¨** (`~/.lakectl.yaml`):
   ```yaml
   server:
     endpoint_url: https://lakefs.3steps.cn
   credentials:
     access_key_id: YOUR_ACCESS_KEY
     secret_access_key: YOUR_SECRET_KEY
   ```

2. **å·¥ä½œåŒºåŒ…å«LakeFSå¼•ç”¨æ–‡ä»¶** (`.lakefs_ref.yaml`):
   ```yaml
   src: lakefs://bdnf-mecfs/main/
   ```

## å®‰è£…è¦æ±‚

### 1. å®‰è£…lakectl
åœ¨ä½¿ç”¨æ­¤æ‰©å±•ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆå®‰è£…lakectlå‘½ä»¤è¡Œå·¥å…·ï¼š

- è®¿é—®ï¼šhttps://docs.lakefs.io/quickstart/installing.html
- æŒ‰ç…§è¯´æ˜å®‰è£…é€‚åˆä½ æ“ä½œç³»ç»Ÿçš„lakectlç‰ˆæœ¬
- ç¡®ä¿lakectlåœ¨ä½ çš„PATHç¯å¢ƒå˜é‡ä¸­

### 2. éªŒè¯å®‰è£…
åœ¨ç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯lakectlæ˜¯å¦æ­£ç¡®å®‰è£…ï¼š
```bash
lakectl --version
```

## ä½¿ç”¨æ–¹æ³•

### æ–¹æ³•1ï¼šé€šè¿‡é¢æ¿æ“ä½œ
1. æ‰“å¼€VSCodeå·¥ä½œåŒº
2. åœ¨èµ„æºç®¡ç†å™¨ä¸­æ‰¾åˆ°"LakeFS"é¢æ¿
3. ç‚¹å‡»ç›¸åº”çš„æ“ä½œé¡¹ç›®

### æ–¹æ³•2ï¼šé€šè¿‡å‘½ä»¤é¢æ¿
æŒ‰ `Cmd+Shift+P` (macOS) æˆ– `Ctrl+Shift+P` (Windows/Linux) æ‰“å¼€å‘½ä»¤é¢æ¿ï¼Œç„¶åè¾“å…¥ï¼š
- `LakeFS: Show Status` - æŸ¥çœ‹çŠ¶æ€
- `LakeFS: Commit Changes` - æäº¤æ›´æ”¹
- `LakeFS: Refresh` - åˆ·æ–°é¢æ¿

### æ–¹æ³•3ï¼šé€šè¿‡é¢æ¿é¡¶éƒ¨æŒ‰é’®
LakeFSé¢æ¿é¡¶éƒ¨æœ‰å››ä¸ªæŒ‰é’®ï¼š
- ğŸ”„ åˆ·æ–°
- ğŸ“Š æŸ¥çœ‹çŠ¶æ€
- ğŸ’¾ æäº¤æ›´æ”¹
- ğŸŒ æ‰“å¼€Web UI

## é…ç½®é€‰é¡¹

åœ¨VSCodeè®¾ç½®ä¸­ï¼Œä½ å¯ä»¥é…ç½®ï¼š

- `lakefs.ignoreFiles`: è¦ç›‘æ§çš„å¿½ç•¥æ–‡ä»¶åˆ—è¡¨ï¼ˆé»˜è®¤ï¼š[".gitignore", ".lakefsignore"]ï¼‰
- `lakefs.enabled`: å¯ç”¨/ç¦ç”¨æ–‡ä»¶è£…é¥°åŠŸèƒ½ï¼ˆé»˜è®¤ï¼štrueï¼‰
- `lakefs.lakectlPath`: è‡ªå®šä¹‰lakectlå¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„ï¼ˆé»˜è®¤ï¼š""ï¼Œä»PATHæœç´¢ï¼‰

### é…ç½®è‡ªå®šä¹‰lakectlè·¯å¾„

å¦‚æœä½ çš„lakectlå®‰è£…åœ¨éæ ‡å‡†ä½ç½®ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼é…ç½®ï¼š

#### æ–¹æ³•1ï¼šé€šè¿‡è®¾ç½®ç•Œé¢
1. æŒ‰ `Cmd+,` (macOS) æˆ– `Ctrl+,` (Windows/Linux) æ‰“å¼€è®¾ç½®
2. æœç´¢ "lakefs.lakectlPath"
3. è¾“å…¥å®Œæ•´çš„lakectlè·¯å¾„ï¼Œä¾‹å¦‚ï¼š
   - macOS/Linux: `/usr/local/bin/lakectl` æˆ– `/home/user/bin/lakectl`
   - Windows: `C:\Program Files\lakectl\lakectl.exe`

#### æ–¹æ³•2ï¼šé€šè¿‡settings.json
åœ¨VSCodeçš„settings.jsonä¸­æ·»åŠ ï¼š
```json
{
    "lakefs.lakectlPath": "/path/to/your/lakectl"
}
```

#### æ–¹æ³•3ï¼šé€šè¿‡é¢æ¿å¿«æ·æ–¹å¼
å½“lakectlæœªæ‰¾åˆ°æ—¶ï¼Œé¢æ¿ä¸­ä¼šæ˜¾ç¤º"âš™ï¸ Configure custom path"é€‰é¡¹ï¼Œç‚¹å‡»å¯ç›´æ¥æ‰“å¼€è®¾ç½®é¡µé¢ã€‚

## æ•…éšœæ’é™¤

### é—®é¢˜1ï¼šé¢æ¿æ˜¾ç¤º"lakectl not found"æˆ–"lakectl path invalid"
**è§£å†³æ–¹æ¡ˆ**ï¼š
1. **å¦‚æœæ˜¾ç¤º"lakectl not found"**ï¼š
   - å®‰è£…lakectlï¼ˆå‚è§å®‰è£…è¦æ±‚ï¼‰
   - ç¡®ä¿lakectlåœ¨PATHä¸­ï¼Œæˆ–é…ç½®è‡ªå®šä¹‰è·¯å¾„
   - ç‚¹å‡»é¢æ¿ä¸­çš„åˆ·æ–°æŒ‰é’®

2. **å¦‚æœæ˜¾ç¤º"lakectl path invalid"**ï¼š
   - æ£€æŸ¥é…ç½®çš„è·¯å¾„æ˜¯å¦æ­£ç¡®
   - ç¡®ä¿æ–‡ä»¶å­˜åœ¨ä¸”å¯æ‰§è¡Œ
   - æ›´æ–° `lakefs.lakectlPath` è®¾ç½®
   - é¢æ¿ä¼šè‡ªåŠ¨åˆ·æ–°

3. **é€šç”¨æ­¥éª¤**ï¼š
   - é‡å¯VSCodeï¼ˆå¦‚æœéœ€è¦ï¼‰
   - ä½¿ç”¨é¢æ¿ä¸­çš„"âš™ï¸ Configure custom path"å¿«æ·æ–¹å¼

### é—®é¢˜2ï¼šå‘½ä»¤æ‰§è¡Œå¤±è´¥
**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥"LakeFS"è¾“å‡ºé€šé“æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯
2. ç¡®ä¿å½“å‰å·¥ä½œåŒºæ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„LakeFSä»“åº“
3. éªŒè¯lakectlé…ç½®æ˜¯å¦æ­£ç¡®

### é—®é¢˜3ï¼šWeb UIåŠŸèƒ½ä¸å¯ç”¨
**è§£å†³æ–¹æ¡ˆ**ï¼š
1. **æ£€æŸ¥lakectlé…ç½®æ–‡ä»¶**ï¼š
   - ç¡®ä¿ `~/.lakectl.yaml` æˆ– `~/.lakectl.yml` å­˜åœ¨
   - éªŒè¯åŒ…å« `server.endpoint_url` å­—æ®µ
2. **æ£€æŸ¥LakeFSå¼•ç”¨æ–‡ä»¶**ï¼š
   - ç¡®ä¿å·¥ä½œåŒºæ ¹ç›®å½•æœ‰ `.lakefs_ref.yaml` æ–‡ä»¶
   - éªŒè¯åŒ…å«æœ‰æ•ˆçš„ `src` å­—æ®µï¼ˆæ ¼å¼: `lakefs://repo/branch/`ï¼‰
3. **é¢æ¿æ˜¾ç¤º**ï¼š
   - å¦‚æœé…ç½®æ­£ç¡®ï¼Œé¢æ¿ä¼šæ˜¾ç¤º"Open Web UI"æŒ‰é’®
   - å¦‚æœé…ç½®ç¼ºå¤±ï¼Œä¼šæ˜¾ç¤º"âš ï¸ Web UI unavailable"

### é—®é¢˜4ï¼šé¢æ¿ä¸æ˜¾ç¤º
**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®ä¿æ‰“å¼€äº†å·¥ä½œåŒºæ–‡ä»¶å¤¹
2. æ£€æŸ¥æ‰©å±•æ˜¯å¦å·²å¯ç”¨
3. å°è¯•é‡æ–°åŠ è½½çª—å£ï¼ˆCmd+R / Ctrl+Rï¼‰

## è°ƒè¯•

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œå¯ä»¥ï¼š
1. æ‰“å¼€VSCodeå¼€å‘è€…æ§åˆ¶å°æŸ¥çœ‹æ—¥å¿—
2. æ£€æŸ¥"LakeFS"è¾“å‡ºé€šé“
3. åœ¨ç»ˆç«¯ä¸­æ‰‹åŠ¨è¿è¡Œlakectlå‘½ä»¤éªŒè¯

## æµ‹è¯•ç”¨Mockè„šæœ¬

ä¸ºäº†æµ‹è¯•æ‰©å±•åŠŸèƒ½ï¼Œé¡¹ç›®åŒ…å«äº†ä¸€ä¸ªmock lakectlè„šæœ¬ (`test-lakectl.sh`)ï¼Œä½ å¯ä»¥ï¼š

```bash
# ä½¿mockè„šæœ¬å¯æ‰§è¡Œ
chmod +x test-lakectl.sh

# åˆ›å»ºè½¯é“¾æ¥ï¼ˆå¯é€‰ï¼Œç”¨äºæµ‹è¯•ï¼‰
mkdir -p ~/bin
ln -sf "$(pwd)/test-lakectl.sh" ~/bin/lakectl
export PATH="$HOME/bin:$PATH"
```

è¿™æ ·ä½ å°±å¯ä»¥æµ‹è¯•æ‰©å±•åŠŸèƒ½è€Œä¸éœ€è¦çœŸæ­£çš„LakeFSç¯å¢ƒã€‚